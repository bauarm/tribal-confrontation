(()=>{"use strict";function t(t){return document.getElementById(t)}function n(t,n){return Math.floor(Math.random()*(n-t+1))+t}let e=!1;const o=requestAnimationFrame,r={tick:0,curTick:0,day:1,mount:3,year:1040,mountName:["","зима","позд. зима","ран. весна","весна","позд. весна","ран. лето","лето","позд. лето","ран. осень","осень","позд. осень","ран. зима"]};function l(t,n,e,o){const r=[];let l=0;for(let c=n;c<n+o-1;c+=1){r.push([]);for(let n=e;n<e+o;n+=1)r[l].push(t[c][n]);l+=1}return r}function c(t,e,o){let r=!0;for(;r;)for(let l=e[0][0];l<e[0][1];l+=1)for(let c=e[1][0];c<e[1][1];c+=1){const e=n(0,7);t[l][c][0]>=0&&3===e&&r&&(t[l][c][0]=o,r=!1)}}function f(t,n){const e=t;return c(e,[[0,4],[0,2]],n),c(e,[[0,4],[3,5]],n),e}function u(t,n,e,o,r){let l,c=0;for(let f=e;f<e+r-1;f+=1){l=0;for(let e=o;e<o+r;e+=1)t[f][e][0]=n[c][l][0],l+=1;c+=1}}const i=t("canvas"),s=32;i.width=544,i.height=544;const a=i.getContext("2d");a.fillStyle="rgb(128, 128, 0)",a.fillRect(0,0,544,544);const h=(t,n,e,o,r)=>{a.fillStyle=r,a.fillRect(t,n,e,o)};function d(t,n){let e=0;for(let o=0;o<t.length;o+=1)for(let r=0;r<t.length;r+=1)t[o][r][0]===n&&(e+=1);return e}function g(t){return function(t){const n=[998];for(let e=1;e<11;e+=1){const o=d(t,e);n.push(o)}return n}(t)}const y=[[255,0,0],[139,0,0],[199,21,133],[255,69,0],[139,69,19],[102,51,153],[255,0,255],[25,25,112],[47,79,79],[0,100,0]],m=["bears","beavers","boars","deers","fishes","foxes","horses","hares","ravens","swifts","wolfes"];function S(t,e){const o=[];for(;o.length<e;){const e=t[n(0,t.length-1)];-1===o.indexOf(e)&&o.push(e)}return o}function b(t,n,e,o){const r=[];let l=0;for(let c=n;c<n+o;c+=1){r.push([]);for(let n=e;n<e+o;n+=1)r[l].push(t[c][n]);l+=1}return r}function v(t,n){const e=t;let o=n.length,r=0;for(let t=0;t<e.length;t+=1)for(let l=0;l<e.length;l+=1)0!==o&&10===e[t][l][0]&&(e[t][l][1]=n[r][0],o-=1,r+=1);return e}function w(t,n,e,o,r){let l,c=0;for(let f=e;f<e+r;f+=1){l=0;for(let e=o;e<o+r;e+=1)t[f][e][1]=n[c][l][1],l+=1;c+=1}}const p=t("canvas").getContext("2d"),M=32;var x=function(t,n,e,o){return new(e||(e=Promise))((function(r,l){function c(t){try{u(o.next(t))}catch(t){l(t)}}function f(t){try{u(o.throw(t))}catch(t){l(t)}}function u(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(c,f)}u((o=o.apply(t,n||[])).next())}))};function T(t,n,e){p.font="9px Ubuntu",p.fillStyle="white",p.fillText(e,t*M+2,n*M+28)}function k(t,n){for(let e=0;e<n.length;e+=1)if(n[e][0]===t)return n[e][1];return"red"}function L(t,n,e,o,r){return x(this,void 0,void 0,(function*(){const l=yield function(t){return new Promise((n=>{const e=`accets/${t}.svg`,o=new Image;o.src=e,o.onload=()=>n(o)}))}(t);return p.drawImage(l,n,e,o,r)}))}var A;!function t(){o(t),e&&function(){const t=document.querySelector("#tday"),n=document.querySelector("#tmount"),e=document.querySelector("#tyear");t.innerHTML=r.day.toString(),n.innerHTML=r.mountName[r.mount],e.innerHTML=r.year.toString(),r.tick+=1,r.tick>10&&(r.day+=1,r.tick=0,t.innerHTML=r.day.toString()),r.day>30&&(r.mount+=1,r.day=1,n.innerHTML=r.mountName[r.mount]),r.mount>12&&(r.year+=1,r.mount=1,e.innerHTML=r.year.toString())}()}(),null===(A=document.querySelector("#pauseBtn"))||void 0===A||A.addEventListener("click",(()=>{e=!e}));const H=t("canvas");H.width=512,H.height=512;const $=H.getContext("2d");$.fillStyle="rgb(128, 128, 0)",$.fillRect(0,0,512,512);const q=function(t=17){const e=function(t=16){const e=function(t=16){const n=[];for(let e=0;e<t;e+=1){n[e]=new Array(t).fill(0);for(let o=0;o<t;o+=1)n[e][o]=[-1,0,0]}return n}(t);for(let o=1;o<t-1;o+=1){const r=Math.floor(n(1,3)),l=Math.floor(n(t-3,t-1));for(let t=r;t<l;t+=1)e[t][o][0]=0}for(let o=1;o<t-1;o+=1){const r=n(0,3);0===r&&(e[o][1][0]=-1),1===r&&(e[o][t-2][0]=-1)}return function(t){const e=t,o=e.length;for(let r=0;r<o;r+=1)for(let l=0;l<o;l+=1)0===t[r][l][0]&&(e[r][l][0]=n(1,9));return e}(e)}(t),o=Math.floor(t/2),r=[[3,2],[o+1,2],[3,o+1],[o+1,o+1]];for(let t=0;t<4;t+=1)u(e,f(l(e,r[t][0],r[t][1],5),10),r[t][0],r[t][1],5);return e}(16);(function(t){for(let n=0;n<t.length;n+=1)for(let e=0;e<t.length;e+=1)a.strokeStyle="white",a.strokeRect(n*s,e*s,s,s),a.font="12px Ubuntu",10===t[n][e][0]?a.fillStyle="blue":a.fillStyle="red",10===t[n][e][0]?(h(n*s,e*s,s,s,"rgb(0, 153, 0)"),a.fillStyle="blue"):-1===t[n][e][0]?(h(n*s,e*s,s,s,"rgb(0, 128, 255)"),a.fillStyle="blue"):t[n][e][0]<3&&0!==t[n][e][0]?(h(n*s,e*s,s,s,"rgb(204, 204, 0)"),a.fillStyle="white"):t[n][e][0]>2&&t[n][e][0]<10&&(h(n*s,e*s,s,s,"rgb(102, 153, 0)"),a.fillStyle="white"),a.fillText(t[n][e][0],n*s+10,e*s+18)})(q),console.log(`Num of best fields ${g(q)[10]}`),console.log(`Num of worse fields ${g(q)[1]}`);const N=function(t,n){const e=[],o=S(y,8),r=S(m,8);for(let t=0;t<8;t+=1)e.push([]),e[t].push(r[t]),e[t].push(`rgba(${(l=o[t])[0]}, ${l[1]} ,${l[2]}, 255)`),e[t].push([0,0]);var l;return e}();!function(t,n){for(let f=0;f<t.length;f+=1)for(let u=0;u<t.length;u+=1)if(0!==t[f][u][1]){const i=k(t[f][u][1],n);e=f*M,o=u*M,r=M-1,l=M-1,c=i,p.fillStyle=c,p.fillRect(e,o,r,l),T(f,u,t[f][u][1]),L(t[f][u][1],f*M+5,u*M,M-10,M-10)}var e,o,r,l,c}(function(t){const n=t.islandArr,e=Math.floor(t.scale/2),o=[[0,0],[e,0],[0,e],[e,e]],r=t.tribesArr;let l=0;for(let t=0;t<4;t+=1){const c=r.slice(l,l+2);w(n,v(b(n,o[t][0],o[t][1],e),c),o[t][0],o[t][1],e),l+=2}return n}({islandArr:q,tribesArr:N,scale:16}),N)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUdBLEVBQUksRUFBR0EsR0FBSyxFQUFHLENBQ3BDLE1BQU04RyxFQUFjRixFQUFPRyxNQUFNRixFQUFjQSxFQUFlLEdBRzlEN0QsRUFBb0IwRCxFQURLaEUsRUFESCxFQUFjZ0UsRUFBVWpCLEVBQU16RixHQUFHLEdBQUl5RixFQUFNekYsR0FBRyxHQUFJd0YsR0FDbEJzQixHQUNOckIsRUFBTXpGLEdBQUcsR0FBSXlGLEVBQU16RixHQUFHLEdBQUl3RixHQUMxRXFCLEdBQWdCLEMsQ0FFbEIsT0FBT0gsQ0FDVCxDR25COEJNLENBTlIsQ0FDcEJMLFVBQVc5QixFQUNYakMsVUFBV3NELEVBQ1hwQixNQTFCdUIsS0FnQ2NvQixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2VicGFjay1kZW1vLy4vc3JjL0hlbHBlcnMudHMiLCJ3ZWJwYWNrOi8vd2VicGFjay1kZW1vLy4vc3JjL0FuaW1hdGlvbi50cyIsIndlYnBhY2s6Ly93ZWJwYWNrLWRlbW8vLi9zcmMvZ2VuZXJhdGVJc2xhbmQudHMiLCJ3ZWJwYWNrOi8vd2VicGFjay1kZW1vLy4vc3JjL2RyYXdJc2xhbmQudHMiLCJ3ZWJwYWNrOi8vd2VicGFjay1kZW1vLy4vc3JjL3N0YXRpY0ZvcklzbGFuZC50cyIsIndlYnBhY2s6Ly93ZWJwYWNrLWRlbW8vLi9zcmMvZ2VuZXJhdGVUcmFiZXMudHMiLCJ3ZWJwYWNrOi8vd2VicGFjay1kZW1vLy4vc3JjL3NldFRyaWJlcy50cyIsIndlYnBhY2s6Ly93ZWJwYWNrLWRlbW8vLi9zcmMvZ2xvYmFsLnRzIiwid2VicGFjazovL3dlYnBhY2stZGVtby8uL3NyYy9kcmF3VHJpYmVzLnRzIiwid2VicGFjazovL3dlYnBhY2stZGVtby8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gZ2V0SWQoaWQ6IHN0cmluZyk6YW55IHtcbiAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1pbm1heFJhbmQobWluOm51bWJlciwgbWF4Om51bWJlcik6bnVtYmVyIHtcbiAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb2xvcigpOnN0cmluZyB7XG4gIGNvbnN0IHI6bnVtYmVyID0gbWlubWF4UmFuZCgwLCAyNTUpO1xuICBjb25zdCBnOm51bWJlciA9IG1pbm1heFJhbmQoMCwgMjU1KTtcbiAgY29uc3QgYjpudW1iZXIgPSBtaW5tYXhSYW5kKDAsIDI1NSk7XG4gIGNvbnN0IGNvbG9yOnN0cmluZyA9IGByZ2JhKCR7cn0sICR7Z30gLCR7Yn0sIDI1NSlgO1xuICByZXR1cm4gY29sb3I7XG59XG4iLCJsZXQgaXNQYXVzZWQ6Ym9vbGVhbiA9IGZhbHNlO1xuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZnVuYy1uYW1lc1xuY29uc3QgbmV4dEdhbWVTdGVwID0gKGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHJlcXVlc3RBbmltYXRpb25GcmFtZTtcbn0oKSk7XG5cbmludGVyZmFjZSBJVGltZXIge1xuICB0aWNrOm51bWJlcjtcbiAgY3VyVGljazpudW1iZXI7XG4gIGRheTpudW1iZXI7XG4gIG1vdW50Om51bWJlcjtcbiAgeWVhcjpudW1iZXI7XG4gIG1vdW50TmFtZTpBcnJheTxzdHJpbmc+O1xufVxuXG5leHBvcnQgY29uc3QgdGltZXI6SVRpbWVyID0ge1xuICB0aWNrOiAwLFxuICBjdXJUaWNrOiAwLFxuICBkYXk6IDEsXG4gIG1vdW50OiAzLFxuICB5ZWFyOiAxMDQwLFxuICBtb3VudE5hbWU6IFtcIlwiLCBcItC30LjQvNCwXCIsIFwi0L/QvtC30LQuINC30LjQvNCwXCIsIFwi0YDQsNC9LiDQstC10YHQvdCwXCIsIFwi0LLQtdGB0L3QsFwiLCBcItC/0L7Qt9C0LiDQstC10YHQvdCwXCIsIFwi0YDQsNC9LiDQu9C10YLQvlwiLCBcItC70LXRgtC+XCIsIFwi0L/QvtC30LQuINC70LXRgtC+XCIsIFwi0YDQsNC9LiDQvtGB0LXQvdGMXCIsIFwi0L7RgdC10L3RjFwiLCBcItC/0L7Qt9C0LiDQvtGB0LXQvdGMXCIsIFwi0YDQsNC9LiDQt9C40LzQsFwiXSxcbn07XG5cbmZ1bmN0aW9uIG1ha2VUaW1lKCkge1xuICBjb25zdCBjZGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0ZGF5XCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gIGNvbnN0IGNtb3VudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdG1vdW50XCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gIGNvbnN0IGN5ZWFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0eWVhclwiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICBjZGF5LmlubmVySFRNTCA9IHRpbWVyLmRheS50b1N0cmluZygpO1xuICBjbW91bnQuaW5uZXJIVE1MID0gdGltZXIubW91bnROYW1lW3RpbWVyLm1vdW50XTtcbiAgY3llYXIuaW5uZXJIVE1MID0gdGltZXIueWVhci50b1N0cmluZygpO1xuICB0aW1lci50aWNrICs9IDE7XG4gIGlmICh0aW1lci50aWNrID4gMTApIHtcbiAgICB0aW1lci5kYXkgKz0gMTtcbiAgICB0aW1lci50aWNrID0gMDtcbiAgICBjZGF5LmlubmVySFRNTCA9IHRpbWVyLmRheS50b1N0cmluZygpO1xuICB9XG4gIGlmICh0aW1lci5kYXkgPiAzMCkge1xuICAgIHRpbWVyLm1vdW50ICs9IDE7XG4gICAgdGltZXIuZGF5ID0gMTtcbiAgICBjbW91bnQuaW5uZXJIVE1MID0gdGltZXIubW91bnROYW1lW3RpbWVyLm1vdW50XTtcbiAgfVxuICBpZiAodGltZXIubW91bnQgPiAxMikge1xuICAgIHRpbWVyLnllYXIgKz0gMTtcbiAgICB0aW1lci5tb3VudCA9IDE7XG4gICAgY3llYXIuaW5uZXJIVE1MID0gdGltZXIueWVhci50b1N0cmluZygpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnYW1lKCk6dm9pZCB7XG4gIG5leHRHYW1lU3RlcChnYW1lKTtcbiAgaWYgKGlzUGF1c2VkKSB7XG4gICAgbWFrZVRpbWUoKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0UGF1c2VkKCk6dm9pZCB7XG4gIGlzUGF1c2VkID0gIWlzUGF1c2VkO1xufVxuIiwiLyogZXNsaW50LWRpc2FibGUgaW1wb3J0L2V4dGVuc2lvbnMgKi9cbi8qIGVzbGludC1kaXNhYmxlIGltcG9ydC9uby11bnJlc29sdmVkICovXG5pbXBvcnQgeyBtaW5tYXhSYW5kIH0gZnJvbSBcIi4vSGVscGVyc1wiO1xuXG5mdW5jdGlvbiBmaWxsQXJyV29ybGQoc2NhbGU6bnVtYmVyID0gMTYpOkFycmF5PGFueT4ge1xuICBjb25zdCBhcnI6QXJyYXk8YW55PiA9IFtdO1xuICBmb3IgKGxldCBpOm51bWJlciA9IDA7IGkgPCBzY2FsZTsgaSArPSAxKSB7XG4gICAgYXJyW2ldID0gKG5ldyBBcnJheShzY2FsZSkpLmZpbGwoMCk7XG4gICAgZm9yIChsZXQgajpudW1iZXIgPSAwOyBqIDwgc2NhbGU7IGogKz0gMSkge1xuICAgICAgYXJyW2ldW2pdID0gWy0xLCAwLCAwXTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGFycjtcbn1cblxuZnVuY3Rpb24gc2V0UmFuZG9tU2NvcmVGb3JBbGxBcmVhKG1hdHJpeDpBcnJheTxhbnk+KTpBcnJheTxhbnk+IHtcbiAgY29uc3QgbmV3QXJyYXk6QXJyYXk8YW55PiA9IG1hdHJpeDtcbiAgY29uc3QgbGVuID0gbmV3QXJyYXkubGVuZ3RoO1xuICBmb3IgKGxldCBpOm51bWJlciA9IDA7IGkgPCBsZW47IGkgKz0gMSkge1xuICAgIGZvciAobGV0IGo6bnVtYmVyID0gMDsgaiA8IGxlbjsgaiArPSAxKSB7XG4gICAgICBpZiAobWF0cml4W2ldW2pdWzBdID09PSAwKSB7XG4gICAgICAgIG5ld0FycmF5W2ldW2pdWzBdID0gbWlubWF4UmFuZCgxLCA5KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG5ld0FycmF5O1xufVxuXG5mdW5jdGlvbiBtYWtlR3JvdW5kKHNjYWxlOm51bWJlciA9IDE2KTpBcnJheTxhbnk+IHtcbiAgY29uc3QgYXJyOkFycmF5PGFueT4gPSBmaWxsQXJyV29ybGQoc2NhbGUpO1xuICBmb3IgKGxldCBpOm51bWJlciA9IDE7IGkgPCBzY2FsZSAtIDE7IGkgKz0gMSkge1xuICAgIGNvbnN0IHN0YXJ0UG9pbnQ6bnVtYmVyID0gTWF0aC5mbG9vcihtaW5tYXhSYW5kKDEsIDMpKTtcbiAgICBjb25zdCBlbmRQb2ludDpudW1iZXIgPSBNYXRoLmZsb29yKG1pbm1heFJhbmQoKHNjYWxlIC0gMyksIHNjYWxlIC0gMSkpO1xuICAgIGZvciAobGV0IGo6bnVtYmVyID0gc3RhcnRQb2ludDsgaiA8IGVuZFBvaW50OyBqICs9IDEpIHtcbiAgICAgIGFycltqXVtpXVswXSA9IDA7XG4gICAgfVxuICB9XG4gIGZvciAobGV0IHE6bnVtYmVyID0gMTsgcSA8IHNjYWxlIC0gMTsgcSArPSAxKSB7XG4gICAgY29uc3QgcGFzc1N0ZXAgPSBtaW5tYXhSYW5kKDAsIDMpO1xuICAgIGlmIChwYXNzU3RlcCA9PT0gMCkgYXJyW3FdWzFdWzBdID0gLTE7XG4gICAgaWYgKHBhc3NTdGVwID09PSAxKSBhcnJbcV1bc2NhbGUgLSAyXVswXSA9IC0xO1xuICB9XG4gIGNvbnN0IGZpbmFsQXJyID0gc2V0UmFuZG9tU2NvcmVGb3JBbGxBcmVhKGFycik7XG4gIHJldHVybiBmaW5hbEFycjtcbn1cblxuZnVuY3Rpb24gZ2V0TWF0cml4QXJlYShtYXRyaXg6QXJyYXk8YW55PiwgeDpudW1iZXIsIHk6bnVtYmVyLCBzaXplOm51bWJlcik6QXJyYXk8YW55PiB7XG4gIGNvbnN0IG5ld0FycmF5OkFycmF5PGFueT4gPSBbXTtcbiAgbGV0IGNudDpudW1iZXIgPSAwO1xuICBmb3IgKGxldCBpOm51bWJlciA9IHg7IGkgPCB4ICsgc2l6ZSAtIDE7IGkgKz0gMSkge1xuICAgIG5ld0FycmF5LnB1c2goW10pO1xuICAgIGZvciAobGV0IGo6bnVtYmVyID0geTsgaiA8IHkgKyBzaXplOyBqICs9IDEpIHtcbiAgICAgIG5ld0FycmF5W2NudF0ucHVzaChtYXRyaXhbaV1bal0pO1xuICAgIH1cbiAgICBjbnQgKz0gMTtcbiAgfVxuICByZXR1cm4gbmV3QXJyYXk7XG59XG5cbmZ1bmN0aW9uIHNldE1pbmlBcmVhc1F1YWxpdHkoUXVhcnRSZWdpb25BcnI6QXJyYXk8YW55PiwgcG9zOkFycmF5PGFueT4sIHBvaW50Om51bWJlcik6dm9pZCB7XG4gIGxldCBxbnQ6Ym9vbGVhbiA9IHRydWU7XG4gIHdoaWxlIChxbnQpIHtcbiAgICBmb3IgKGxldCBpOm51bWJlciA9IHBvc1swXVswXTsgaSA8IHBvc1swXVsxXTsgaSArPSAxKSB7XG4gICAgICBmb3IgKGxldCBqOm51bWJlciA9IHBvc1sxXVswXTsgaiA8IHBvc1sxXVsxXTsgaiArPSAxKSB7XG4gICAgICAgIGNvbnN0IHBhc3NTdGVwID0gbWlubWF4UmFuZCgwLCA3KTtcbiAgICAgICAgaWYgKFF1YXJ0UmVnaW9uQXJyW2ldW2pdWzBdID49IDAgJiYgcGFzc1N0ZXAgPT09IDMgJiYgcW50KSB7XG4gICAgICAgICAgUXVhcnRSZWdpb25BcnJbaV1bal1bMF0gPSBwb2ludDtcbiAgICAgICAgICBxbnQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBzZXRBcmVhc1F1YWxpdHkobWF0cml4OkFycmF5PGFueT4sIHF1YW50aXR5Om51bWJlcik6QXJyYXk8YW55PiB7XG4gIGNvbnN0IG5ld0FycmF5OkFycmF5PGFueT4gPSBtYXRyaXg7XG4gIHNldE1pbmlBcmVhc1F1YWxpdHkobmV3QXJyYXksIFtbMCwgNF0sIFswLCAyXV0sIHF1YW50aXR5KTtcbiAgc2V0TWluaUFyZWFzUXVhbGl0eShuZXdBcnJheSwgW1swLCA0XSwgWzMsIDVdXSwgcXVhbnRpdHkpO1xuICByZXR1cm4gbmV3QXJyYXk7XG59XG5cbi8vIGNvbnN0IGFyckZyYWcyID0gc2V0QXJlYXNRdWFsaXR5KGFyckZyYWcsIDEwMCwgMyk7XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGVuXG5mdW5jdGlvbiBzZXRNYXRyaXhBcmVhKG1hdHJpeDpBcnJheTxhbnk+LCBOZXdNYXRyaXg6QXJyYXk8YW55PiwgeDpudW1iZXIsIHk6bnVtYmVyLCBzaXplOm51bWJlcik6dm9pZCB7XG4gIGxldCByb3c6bnVtYmVyID0gMDtcbiAgbGV0IGNvbDpudW1iZXI7XG4gIGZvciAobGV0IGk6bnVtYmVyID0geDsgaSA8IHggKyBzaXplIC0gMTsgaSArPSAxKSB7XG4gICAgY29sID0gMDtcbiAgICBmb3IgKGxldCBqOm51bWJlciA9IHk7IGogPCB5ICsgc2l6ZTsgaiArPSAxKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWRlc3RydWN0dXJpbmcsIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgICBtYXRyaXhbaV1bal1bMF0gPSBOZXdNYXRyaXhbcm93XVtjb2xdWzBdO1xuICAgICAgY29sICs9IDE7XG4gICAgfVxuICAgIHJvdyArPSAxO1xuICB9XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlUmVnaW9ucyhzY2FsZTpudW1iZXIgPSAxNyk6QXJyYXk8YW55PiB7XG4gIGNvbnN0IG1hdHJpeCA9IG1ha2VHcm91bmQoc2NhbGUpO1xuICBjb25zdCByZWdpb25TaXplOm51bWJlciA9IE1hdGguZmxvb3Ioc2NhbGUgLyAyKTtcbiAgY29uc3Qgc3RlcHMgPSBbWzMsIDJdLCBbcmVnaW9uU2l6ZSArIDEsIDJdLCBbMywgcmVnaW9uU2l6ZSArIDFdLCBbcmVnaW9uU2l6ZSArIDEsIHJlZ2lvblNpemUgKyAxXV07XG4gIGZvciAobGV0IGk6bnVtYmVyID0gMDsgaSA8IDQ7IGkgKz0gMSkge1xuICAgIGNvbnN0IEVtcHR5UXVhcnRBcnIgPSBnZXRNYXRyaXhBcmVhKG1hdHJpeCwgc3RlcHNbaV1bMF0sIHN0ZXBzW2ldWzFdLCA1KTtcbiAgICBjb25zdCBGdWxsUXVhcnRBcnIgPSBzZXRBcmVhc1F1YWxpdHkoRW1wdHlRdWFydEFyciwgMTApO1xuICAgIHNldE1hdHJpeEFyZWEobWF0cml4LCBGdWxsUXVhcnRBcnIsIHN0ZXBzW2ldWzBdLCBzdGVwc1tpXVsxXSwgNSk7XG4gIH1cbiAgcmV0dXJuIG1hdHJpeDtcbn1cbi8qKlxuKiBAcGFyYW0gc2NhbGUgU2l6ZSBnZW5lcmF0ZSBhcmVhLCBvbmx5IG9kZFxuKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdlbmVyYXRlSXNsYW5kKHNjYWxlOm51bWJlcikge1xuICByZXR1cm4gZ2VuZXJhdGVSZWdpb25zKHNjYWxlKTtcbn1cbiIsIi8qIGVzbGludC1kaXNhYmxlIGltcG9ydC9leHRlbnNpb25zICovXG4vKiBlc2xpbnQtZGlzYWJsZSBpbXBvcnQvbm8tdW5yZXNvbHZlZCAqL1xuaW1wb3J0IHsgZ2V0SWQgfSBmcm9tIFwiLi9IZWxwZXJzXCI7XG5cbmNvbnN0IGNhbnZhcyA9IGdldElkKFwiY2FudmFzXCIpO1xuXG5jb25zdCBncmlkOm51bWJlciA9IDMyO1xuY29uc3Qgc2l6ZUZpZWxkOm51bWJlciA9IDE3O1xuXG5jb25zdCBzaXplU2NlbmVYOm51bWJlciA9IGdyaWQgKiBzaXplRmllbGQ7XG5jb25zdCBzaXplU2NlbmVZOm51bWJlciA9IGdyaWQgKiBzaXplRmllbGQ7XG5cbmNhbnZhcy53aWR0aCA9IHNpemVTY2VuZVg7XG5jYW52YXMuaGVpZ2h0ID0gc2l6ZVNjZW5lWTtcbmNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG5jdHguZmlsbFN0eWxlID0gXCJyZ2IoMTI4LCAxMjgsIDApXCI7XG5jdHguZmlsbFJlY3QoMCwgMCwgc2l6ZVNjZW5lWCwgc2l6ZVNjZW5lWSk7XG5cbmNvbnN0IHJlY3QgPSAoeDpudW1iZXIsIHk6bnVtYmVyLCB3Om51bWJlciwgaDpudW1iZXIsIGNvbG9yOnN0cmluZyk6dm9pZCA9PiB7XG4gIGN0eC5maWxsU3R5bGUgPSBjb2xvcjtcbiAgY3R4LmZpbGxSZWN0KHgsIHksIHcsIGgpO1xufTtcblxuZnVuY3Rpb24gZHJhd0ZpZWxkKG1hdHJpeDpBcnJheTxhbnk+KTp2b2lkIHtcbiAgZm9yIChsZXQgaTpudW1iZXIgPSAwOyBpIDwgbWF0cml4Lmxlbmd0aDsgaSArPSAxKSB7XG4gICAgZm9yIChsZXQgajpudW1iZXIgPSAwOyBqIDwgbWF0cml4Lmxlbmd0aDsgaiArPSAxKSB7XG4gICAgICBjdHguc3Ryb2tlU3R5bGUgPSBcIndoaXRlXCI7XG4gICAgICBjdHguc3Ryb2tlUmVjdChpICogZ3JpZCwgaiAqIGdyaWQsIGdyaWQsIGdyaWQpO1xuICAgICAgY3R4LmZvbnQgPSBcIjEycHggVWJ1bnR1XCI7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLWV4cHJlc3Npb25zXG4gICAgICBtYXRyaXhbaV1bal1bMF0gPT09IDEwID8gY3R4LmZpbGxTdHlsZSA9IFwiYmx1ZVwiIDogY3R4LmZpbGxTdHlsZSA9IFwicmVkXCI7XG4gICAgICBpZiAobWF0cml4W2ldW2pdWzBdID09PSAxMCkge1xuICAgICAgICByZWN0KGkgKiBncmlkLCBqICogZ3JpZCwgZ3JpZCwgZ3JpZCwgXCJyZ2IoMCwgMTUzLCAwKVwiKTtcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwiYmx1ZVwiO1xuICAgICAgfSBlbHNlIGlmIChtYXRyaXhbaV1bal1bMF0gPT09IC0xKSB7XG4gICAgICAgIHJlY3QoaSAqIGdyaWQsIGogKiBncmlkLCBncmlkLCBncmlkLCBcInJnYigwLCAxMjgsIDI1NSlcIik7XG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSBcImJsdWVcIjtcbiAgICAgIH0gZWxzZSBpZiAobWF0cml4W2ldW2pdWzBdIDwgMyAmJiBtYXRyaXhbaV1bal1bMF0gIT09IDApIHtcbiAgICAgICAgcmVjdChpICogZ3JpZCwgaiAqIGdyaWQsIGdyaWQsIGdyaWQsIFwicmdiKDIwNCwgMjA0LCAwKVwiKTtcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwid2hpdGVcIjtcbiAgICAgIH0gZWxzZSBpZiAobWF0cml4W2ldW2pdWzBdID4gMiAmJiBtYXRyaXhbaV1bal1bMF0gPCAxMCkge1xuICAgICAgICByZWN0KGkgKiBncmlkLCBqICogZ3JpZCwgZ3JpZCwgZ3JpZCwgXCJyZ2IoMTAyLCAxNTMsIDApXCIpO1xuICAgICAgICBjdHguZmlsbFN0eWxlID0gXCJ3aGl0ZVwiO1xuICAgICAgfVxuICAgICAgY3R4LmZpbGxUZXh0KG1hdHJpeFtpXVtqXVswXSwgaSAqIGdyaWQgKyAxMCwgaiAqIGdyaWQgKyAxOCk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGRyYXdJc2xhbmQobWF0cml4OkFycmF5PGFueT4pOnZvaWQge1xuICByZXR1cm4gZHJhd0ZpZWxkKG1hdHJpeCk7XG59XG4iLCJmdW5jdGlvbiBjb3VudEZpZWxkcyhtYXRyaXg6QXJyYXk8YW55PiwgcGxhY2VTY29yZTpudW1iZXIpOm51bWJlciB7XG4gIGxldCBjb3VudCA9IDA7XG4gIGZvciAobGV0IGk6bnVtYmVyID0gMDsgaSA8IG1hdHJpeC5sZW5ndGg7IGkgKz0gMSkge1xuICAgIGZvciAobGV0IGo6bnVtYmVyID0gMDsgaiA8IG1hdHJpeC5sZW5ndGg7IGogKz0gMSkge1xuICAgICAgaWYgKG1hdHJpeFtpXVtqXVswXSA9PT0gcGxhY2VTY29yZSkge1xuICAgICAgICBjb3VudCArPSAxO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gY291bnQ7XG59XG5cbmZ1bmN0aW9uIGNvdW50U2NvcmVBbGxGaWVsZHMobWF0cml4OkFycmF5PGFueT4pOkFycmF5PG51bWJlcj4ge1xuICBjb25zdCBjb3VudEFycmF5OkFycmF5PG51bWJlcj4gPSBbOTk4XTtcbiAgZm9yIChsZXQgaTpudW1iZXIgPSAxOyBpIDwgMTE7IGkgKz0gMSkge1xuICAgIGNvbnN0IGNvdW50Om51bWJlciA9IGNvdW50RmllbGRzKG1hdHJpeCwgaSk7XG4gICAgY291bnRBcnJheS5wdXNoKGNvdW50KTtcbiAgfVxuICByZXR1cm4gY291bnRBcnJheTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gc3RhdGljRm9yRmllbGRTY29yZXMobWF0cml4OkFycmF5PGFueT4pIHtcbiAgcmV0dXJuIGNvdW50U2NvcmVBbGxGaWVsZHMobWF0cml4KTtcbn1cbiIsIi8qIGVzbGludC1kaXNhYmxlIGltcG9ydC9leHRlbnNpb25zICovXG4vKiBlc2xpbnQtZGlzYWJsZSBpbXBvcnQvbm8tdW5yZXNvbHZlZCAqL1xuaW1wb3J0IHsgbWlubWF4UmFuZCB9IGZyb20gXCIuL0hlbHBlcnNcIjtcblxuY29uc3QgYWxsVHJpYmVzQ29sb3IgPSBbWzI1NSwgMCwgMF0sIFsxMzksIDAsIDBdLCBbMTk5LCAyMSwgMTMzXSwgWzI1NSwgNjksIDBdLCBbMTM5LCA2OSwgMTldLFxuICBbMTAyLCA1MSwgMTUzXSwgWzI1NSwgMCwgMjU1XSwgWzI1LCAyNSwgMTEyXSwgWzQ3LCA3OSwgNzldLCBbMCwgMTAwLCAwXV07XG5jb25zdCBhbGxUb3RlbU5hbWVzID0gW1wiYmVhcnNcIiwgXCJiZWF2ZXJzXCIsIFwiYm9hcnNcIiwgXCJkZWVyc1wiLCBcImZpc2hlc1wiLCBcImZveGVzXCIsIFwiaG9yc2VzXCIsIFwiaGFyZXNcIiwgXCJyYXZlbnNcIiwgXCJzd2lmdHNcIiwgXCJ3b2xmZXNcIl07IC8vIFwiZm9nc1wiLCBcInNoYWtlc1wiXG5cbmZ1bmN0aW9uIGdldFRyaWJlQXR0cmlidXR0ZXMoYXRyaWJ1dGVzOkFycmF5PGFueT4sIG51bU9mdHJpYmVzOm51bWJlcik6QXJyYXk8YW55PiB7XG4gIGNvbnN0IHRyYWJlc0F0dHI6QXJyYXk8YW55PiA9IFtdO1xuICB3aGlsZSAodHJhYmVzQXR0ci5sZW5ndGggPCBudW1PZnRyaWJlcykge1xuICAgIGNvbnN0IHJhbmRBdHRyID0gYXRyaWJ1dGVzW21pbm1heFJhbmQoMCwgYXRyaWJ1dGVzLmxlbmd0aCAtIDEpXTtcbiAgICBpZiAodHJhYmVzQXR0ci5pbmRleE9mKHJhbmRBdHRyKSA9PT0gLTEpIHtcbiAgICAgIHRyYWJlc0F0dHIucHVzaChyYW5kQXR0cik7XG4gICAgfVxuICB9XG4gIHJldHVybiB0cmFiZXNBdHRyO1xufVxuXG5mdW5jdGlvbiBmb3JtUmdiYVN0cmluZyhyZ2I6QXJyYXk8bnVtYmVyPik6c3RyaW5nIHtcbiAgY29uc3QgcjpudW1iZXIgPSByZ2JbMF07XG4gIGNvbnN0IGc6bnVtYmVyID0gcmdiWzFdO1xuICBjb25zdCBiOm51bWJlciA9IHJnYlsyXTtcbiAgY29uc3QgY29sb3I6c3RyaW5nID0gYHJnYmEoJHtyfSwgJHtnfSAsJHtifSwgMjU1KWA7XG4gIHJldHVybiBjb2xvcjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2VuZXJhdGVUcmFiZXMobWF0cml4OkFycmF5PGFueT4sIG51bU9mdHJpYmVzOm51bWJlcik6QXJyYXk8YW55PiB7XG4gIGNvbnN0IHRyaWJhbHM6QXJyYXk8YW55PiA9IFtdO1xuICBjb25zdCB0cmliZXNDb2xvcjpBcnJheTxhbnk+ID0gZ2V0VHJpYmVBdHRyaWJ1dHRlcyhhbGxUcmliZXNDb2xvciwgbnVtT2Z0cmliZXMpO1xuICBjb25zdCB0cmliZXNUb3RlbU5hbWVzOkFycmF5PHN0cmluZz4gPSBnZXRUcmliZUF0dHJpYnV0dGVzKGFsbFRvdGVtTmFtZXMsIG51bU9mdHJpYmVzKTtcbiAgZm9yIChsZXQgaTpudW1iZXIgPSAwOyBpIDwgbnVtT2Z0cmliZXM7IGkgKz0gMSkge1xuICAgIHRyaWJhbHMucHVzaChbXSk7XG4gICAgdHJpYmFsc1tpXS5wdXNoKHRyaWJlc1RvdGVtTmFtZXNbaV0pO1xuICAgIHRyaWJhbHNbaV0ucHVzaChmb3JtUmdiYVN0cmluZyh0cmliZXNDb2xvcltpXSkpO1xuICAgIHRyaWJhbHNbaV0ucHVzaChbMCwgMF0pO1xuICB9XG4gIHJldHVybiB0cmliYWxzO1xufVxuIiwiZnVuY3Rpb24gZ2V0TWF0cml4QXJlYShtYXRyaXg6QXJyYXk8YW55PiwgeDpudW1iZXIsIHk6bnVtYmVyLCBzaXplOm51bWJlcik6QXJyYXk8YW55PiB7XG4gIGNvbnN0IG5ld0FycmF5OkFycmF5PGFueT4gPSBbXTtcbiAgbGV0IGNudDpudW1iZXIgPSAwO1xuICBmb3IgKGxldCBpOm51bWJlciA9IHg7IGkgPCB4ICsgc2l6ZTsgaSArPSAxKSB7XG4gICAgbmV3QXJyYXkucHVzaChbXSk7XG4gICAgZm9yIChsZXQgajpudW1iZXIgPSB5OyBqIDwgeSArIHNpemU7IGogKz0gMSkge1xuICAgICAgbmV3QXJyYXlbY250XS5wdXNoKG1hdHJpeFtpXVtqXSk7XG4gICAgfVxuICAgIGNudCArPSAxO1xuICB9XG4gIHJldHVybiBuZXdBcnJheTtcbn1cblxuZnVuY3Rpb24gc2V0VHJhYmVzVGVzdChyZWdpb25BcnI6QXJyYXk8YW55PiwgdHJpYmVzQXJyOkFycmF5PGFueT4pOkFycmF5PGFueT4ge1xuICBjb25zdCByZWdBcnJheTpBcnJheTxhbnk+ID0gcmVnaW9uQXJyO1xuICBsZXQgY291bnRlciA9IHRyaWJlc0Fyci5sZW5ndGg7XG4gIGxldCBjb3VudENoYW5rID0gMDtcbiAgZm9yIChsZXQgaTpudW1iZXIgPSAwOyBpIDwgcmVnQXJyYXkubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBmb3IgKGxldCBqOm51bWJlciA9IDA7IGogPCByZWdBcnJheS5sZW5ndGg7IGogKz0gMSkge1xuICAgICAgaWYgKGNvdW50ZXIgIT09IDAgJiYgcmVnQXJyYXlbaV1bal1bMF0gPT09IDEwKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItZGVzdHJ1Y3R1cmluZ1xuICAgICAgICByZWdBcnJheVtpXVtqXVsxXSA9IHRyaWJlc0Fycltjb3VudENoYW5rXVswXTtcbiAgICAgICAgY291bnRlciAtPSAxO1xuICAgICAgICBjb3VudENoYW5rICs9IDE7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiByZWdBcnJheTtcbn1cblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1sZW5cbmZ1bmN0aW9uIHNldFJlZ2lvbldpdGhUcmFiZXMocmVnaW9uQXJyOkFycmF5PGFueT4sIHJlZ1RyaWJlczpBcnJheTxhbnk+LCB4Om51bWJlciwgeTpudW1iZXIsIHNpemU6bnVtYmVyKTp2b2lkIHtcbiAgbGV0IHJvdzpudW1iZXIgPSAwO1xuICBsZXQgY29sOm51bWJlcjtcbiAgZm9yIChsZXQgaTpudW1iZXIgPSB4OyBpIDwgeCArIHNpemU7IGkgKz0gMSkge1xuICAgIGNvbCA9IDA7XG4gICAgZm9yIChsZXQgajpudW1iZXIgPSB5OyBqIDwgeSArIHNpemU7IGogKz0gMSkge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1kZXN0cnVjdHVyaW5nLCBuby1wYXJhbS1yZWFzc2lnblxuICAgICAgcmVnaW9uQXJyW2ldW2pdWzFdID0gcmVnVHJpYmVzW3Jvd11bY29sXVsxXTtcbiAgICAgIGNvbCArPSAxO1xuICAgIH1cbiAgICByb3cgKz0gMTtcbiAgfVxufVxuXG5pbnRlcmZhY2Ugc2V0VHJhYmVzIHtcbiAgaXNsYW5kQXJyOkFycmF5PGFueT47XG4gIHRyaWJlc0FycjpBcnJheTxhbnk+O1xuICBzY2FsZTpudW1iZXI7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdlbmVyYXRlSXNsYW5kV2l0aFRyaWJlcyh0cmFiZXNBdHRyOiBzZXRUcmFiZXMpOkFycmF5PGFueT4ge1xuICBjb25zdCBpc2xuZEFycjpBcnJheTxhbnk+ID0gdHJhYmVzQXR0ci5pc2xhbmRBcnI7XG4gIGNvbnN0IHJlZ2lvblNpemU6bnVtYmVyID0gTWF0aC5mbG9vcih0cmFiZXNBdHRyLnNjYWxlIC8gMik7XG4gIGNvbnN0IHN0ZXBzID0gW1swLCAwXSwgW3JlZ2lvblNpemUsIDBdLCBbMCwgcmVnaW9uU2l6ZV0sIFtyZWdpb25TaXplLCByZWdpb25TaXplXV07XG4gIGNvbnN0IHRyYkFycjpBcnJheTxhbnk+ID0gdHJhYmVzQXR0ci50cmliZXNBcnI7XG4gIGxldCBjaGFua0xpbWl0ZXI6bnVtYmVyID0gMDtcbiAgZm9yIChsZXQgaTpudW1iZXIgPSAwOyBpIDwgNDsgaSArPSAxKSB7XG4gICAgY29uc3QgdHJpYmVzQ2hhbmsgPSB0cmJBcnIuc2xpY2UoY2hhbmtMaW1pdGVyLCBjaGFua0xpbWl0ZXIgKyAyKTtcbiAgICBjb25zdCBFbXB0eVF1YXJ0QXJyID0gZ2V0TWF0cml4QXJlYShpc2xuZEFyciwgc3RlcHNbaV1bMF0sIHN0ZXBzW2ldWzFdLCByZWdpb25TaXplKTtcbiAgICBjb25zdCBhcnJSZWdXaXRoVHJpYmVzID0gc2V0VHJhYmVzVGVzdChFbXB0eVF1YXJ0QXJyLCB0cmliZXNDaGFuayk7XG4gICAgc2V0UmVnaW9uV2l0aFRyYWJlcyhpc2xuZEFyciwgYXJyUmVnV2l0aFRyaWJlcywgc3RlcHNbaV1bMF0sIHN0ZXBzW2ldWzFdLCByZWdpb25TaXplKTtcbiAgICBjaGFua0xpbWl0ZXIgKz0gMjtcbiAgfVxuICByZXR1cm4gaXNsbmRBcnI7XG59XG4iLCIvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVucmVzb2x2ZWQsIGltcG9ydC9leHRlbnNpb25zXG5pbXBvcnQgeyBnZXRJZCB9IGZyb20gXCIuL0hlbHBlcnNcIjtcblxuZXhwb3J0IGNvbnN0IGNhbnZhcyA9IGdldElkKFwiY2FudmFzXCIpO1xuZXhwb3J0IGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG5leHBvcnQgY29uc3QgZ3JpZDpudW1iZXIgPSAzMjtcbmV4cG9ydCBjb25zdCBzaXplRmllbGQ6bnVtYmVyID0gMTY7XG5leHBvcnQgY29uc3QgbnVtYmVyT2Z0cmliZXMgPSA4O1xuIiwiLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnJlc29sdmVkLCBpbXBvcnQvZXh0ZW5zaW9uc1xuaW1wb3J0IHsgY3R4LCBncmlkIH0gZnJvbSBcIi4vZ2xvYmFsXCI7XG5cbmNvbnN0IHJlY3QgPSAoeDpudW1iZXIsIHk6bnVtYmVyLCB3Om51bWJlciwgaDpudW1iZXIsIGNvbG9yOnN0cmluZyk6dm9pZCA9PiB7XG4gIGN0eC5maWxsU3R5bGUgPSBjb2xvcjtcbiAgY3R4LmZpbGxSZWN0KHgsIHksIHcsIGgpO1xufTtcblxuZnVuY3Rpb24gd3JpdGVUZXh0KGk6bnVtYmVyLCBqOm51bWJlciwgdGV4dDpzdHJpbmcpOnZvaWQge1xuICBjdHguZm9udCA9IFwiOXB4IFVidW50dVwiO1xuICBjdHguZmlsbFN0eWxlID0gXCJ3aGl0ZVwiO1xuICBjdHguZmlsbFRleHQodGV4dCwgaSAqIGdyaWQgKyAyLCBqICogZ3JpZCArIDI4KTtcbn1cblxuZnVuY3Rpb24gZ2V0VHJpYmVzQ29sb3IodHJhYmVzTmFtZTpzdHJpbmcsIHRyaWJlc0FycjpBcnJheTxhbnk+KTpzdHJpbmcge1xuICBmb3IgKGxldCBpOm51bWJlciA9IDA7IGkgPCB0cmliZXNBcnIubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBpZiAodHJpYmVzQXJyW2ldWzBdID09PSB0cmFiZXNOYW1lKSB7XG4gICAgICByZXR1cm4gdHJpYmVzQXJyW2ldWzFdO1xuICAgIH1cbiAgfVxuICByZXR1cm4gXCJyZWRcIjtcbn1cblxuZnVuY3Rpb24gZ2V0RmxhZyhuYW1lOnN0cmluZykge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBjb25zdCBwYXRoVGVtcGxhdGUgPSBgYWNjZXRzLyR7bmFtZX0uc3ZnYDtcbiAgICBjb25zdCBlbGVtID0gbmV3IEltYWdlKCk7XG4gICAgZWxlbS5zcmMgPSBwYXRoVGVtcGxhdGU7XG4gICAgZWxlbS5vbmxvYWQgPSAoKSA9PiByZXNvbHZlKGVsZW0pO1xuICB9KTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZHJhd0VsZW0obmFtZTpzdHJpbmcsIGE6bnVtYmVyLCBiOm51bWJlciwgYzpudW1iZXIsIGQ6bnVtYmVyKSB7XG4gIGNvbnN0IGVsZW0gPSBhd2FpdCBnZXRGbGFnKG5hbWUpO1xuICByZXR1cm4gY3R4LmRyYXdJbWFnZShlbGVtLCBhLCBiLCBjLCBkKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZHJhd0ZpcnN0VHJpYmVzKElzbGFuZFdpdGhUcmliZXM6QXJyYXk8YW55PiwgdHJpYmVzQXJyOkFycmF5PGFueT4pOnZvaWQge1xuICBmb3IgKGxldCBpOm51bWJlciA9IDA7IGkgPCBJc2xhbmRXaXRoVHJpYmVzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgZm9yIChsZXQgajpudW1iZXIgPSAwOyBqIDwgSXNsYW5kV2l0aFRyaWJlcy5sZW5ndGg7IGogKz0gMSkge1xuICAgICAgaWYgKElzbGFuZFdpdGhUcmliZXNbaV1bal1bMV0gIT09IDApIHtcbiAgICAgICAgY29uc3QgdHJpYmVDb2xvciA9IGdldFRyaWJlc0NvbG9yKElzbGFuZFdpdGhUcmliZXNbaV1bal1bMV0sIHRyaWJlc0Fycik7XG4gICAgICAgIHJlY3QoaSAqIGdyaWQsIGogKiBncmlkLCBncmlkIC0gMSwgZ3JpZCAtIDEsIHRyaWJlQ29sb3IpO1xuICAgICAgICB3cml0ZVRleHQoaSwgaiwgSXNsYW5kV2l0aFRyaWJlc1tpXVtqXVsxXSk7XG4gICAgICAgIGRyYXdFbGVtKElzbGFuZFdpdGhUcmliZXNbaV1bal1bMV0sIGkgKiBncmlkICsgNSwgaiAqIGdyaWQsIGdyaWQgLSAxMCwgZ3JpZCAtIDEwKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiIsIi8qIGVzbGludC1kaXNhYmxlIGltcG9ydC9leHRlbnNpb25zICovXG4vKiBlc2xpbnQtZGlzYWJsZSBpbXBvcnQvbm8tdW5yZXNvbHZlZCAqL1xuaW1wb3J0IHsgZ2V0SWQgfSBmcm9tIFwiLi9IZWxwZXJzXCI7XG5pbXBvcnQgeyBnYW1lLCBzZXRQYXVzZWQgfSBmcm9tIFwiLi9BbmltYXRpb25cIjtcbmltcG9ydCBnZW5lcmF0ZUlzbGFuZCBmcm9tIFwiLi9nZW5lcmF0ZUlzbGFuZFwiO1xuaW1wb3J0IGRyYXdJc2xhbmQgZnJvbSBcIi4vZHJhd0lzbGFuZFwiO1xuaW1wb3J0IHN0YXRpY0ZvckZpZWxkU2NvcmVzIGZyb20gXCIuL3N0YXRpY0ZvcklzbGFuZFwiO1xuaW1wb3J0IGdlbmVyYXRlVHJpYmVzIGZyb20gXCIuL2dlbmVyYXRlVHJhYmVzXCI7XG5pbXBvcnQgZ2VuZXJhdGVJc2xhbmRXaXRoVHJpYmVzIGZyb20gXCIuL3NldFRyaWJlc1wiO1xuaW1wb3J0IGRyYXdGaXJzdFRyaWJlcyBmcm9tIFwiLi9kcmF3VHJpYmVzXCI7XG5cbmdhbWUoKTtcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGF1c2VCdG5cIik/LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBzZXRQYXVzZWQoKSk7XG5cbmNvbnN0IGNhbnZhcyA9IGdldElkKFwiY2FudmFzXCIpO1xuXG5jb25zdCBncmlkOm51bWJlciA9IDMyO1xuY29uc3Qgc2l6ZUZpZWxkOm51bWJlciA9IDE2O1xuXG5jb25zdCBzaXplU2NlbmVYOm51bWJlciA9IGdyaWQgKiBzaXplRmllbGQ7XG5jb25zdCBzaXplU2NlbmVZOm51bWJlciA9IGdyaWQgKiBzaXplRmllbGQ7XG5cbmNhbnZhcy53aWR0aCA9IHNpemVTY2VuZVg7XG5jYW52YXMuaGVpZ2h0ID0gc2l6ZVNjZW5lWTtcbmNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG5jdHguZmlsbFN0eWxlID0gXCJyZ2IoMTI4LCAxMjgsIDApXCI7XG5jdHguZmlsbFJlY3QoMCwgMCwgc2l6ZVNjZW5lWCwgc2l6ZVNjZW5lWSk7XG5cbmNvbnN0IGFyciA9IGdlbmVyYXRlSXNsYW5kKHNpemVGaWVsZCk7XG5cbmRyYXdJc2xhbmQoYXJyKTtcblxuLy8gY29uc29sZS5sb2coc3RhdGljRm9yRmllbGRTY29yZXMoYXJyKSk7XG5jb25zb2xlLmxvZyhgTnVtIG9mIGJlc3QgZmllbGRzICR7c3RhdGljRm9yRmllbGRTY29yZXMoYXJyKVsxMF19YCk7XG5jb25zb2xlLmxvZyhgTnVtIG9mIHdvcnNlIGZpZWxkcyAke3N0YXRpY0ZvckZpZWxkU2NvcmVzKGFycilbMV19YCk7XG5cbmNvbnN0IG51bWJlck9mdHJpYmVzID0gODtcbmNvbnN0IGFsbFRyaWJlczpBcnJheTxhbnk+ID0gZ2VuZXJhdGVUcmliZXMoYXJyLCBudW1iZXJPZnRyaWJlcyk7XG4vLyBjb25zb2xlLmxvZyhhbGxUcmliZXMpO1xuXG5jb25zdCBzZXRUcmliZXNBdHRyID0ge1xuICBpc2xhbmRBcnI6IGFycixcbiAgdHJpYmVzQXJyOiBhbGxUcmliZXMsXG4gIHNjYWxlOiBzaXplRmllbGQsXG59O1xuXG5jb25zdCBpc2xhbmRXaXRoRmlyc3RUcmliZXMgPSBnZW5lcmF0ZUlzbGFuZFdpdGhUcmliZXMoc2V0VHJpYmVzQXR0cik7XG4vLyBjb25zb2xlLmxvZyhcImlzbFwiLCBpc2xhbmRXaXRoRmlyc3RUcmliZXMpO1xuXG5kcmF3Rmlyc3RUcmliZXMoaXNsYW5kV2l0aEZpcnN0VHJpYmVzLCBhbGxUcmliZXMpO1xuXG4vLyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3NldFRyaWJlc1wiKT8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHNldFRyaWJlcygpKTtcblxuLy8gY29uc29sZS5sb2coYWxsVHJpYmVzKTtcbiJdLCJuYW1lcyI6WyJnZXRJZCIsImlkIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm1pbm1heFJhbmQiLCJtaW4iLCJtYXgiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJpc1BhdXNlZCIsIm5leHRHYW1lU3RlcCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInRpbWVyIiwidGljayIsImN1clRpY2siLCJkYXkiLCJtb3VudCIsInllYXIiLCJtb3VudE5hbWUiLCJnZXRNYXRyaXhBcmVhIiwibWF0cml4IiwieCIsInkiLCJzaXplIiwibmV3QXJyYXkiLCJjbnQiLCJpIiwicHVzaCIsImoiLCJzZXRNaW5pQXJlYXNRdWFsaXR5IiwiUXVhcnRSZWdpb25BcnIiLCJwb3MiLCJwb2ludCIsInFudCIsInBhc3NTdGVwIiwic2V0QXJlYXNRdWFsaXR5IiwicXVhbnRpdHkiLCJzZXRNYXRyaXhBcmVhIiwiTmV3TWF0cml4IiwiY29sIiwicm93IiwiY2FudmFzIiwiZ3JpZCIsIndpZHRoIiwiaGVpZ2h0IiwiY3R4IiwiZ2V0Q29udGV4dCIsImZpbGxTdHlsZSIsImZpbGxSZWN0IiwicmVjdCIsInciLCJoIiwiY29sb3IiLCJjb3VudEZpZWxkcyIsInBsYWNlU2NvcmUiLCJjb3VudCIsImxlbmd0aCIsInN0YXRpY0ZvckZpZWxkU2NvcmVzIiwiY291bnRBcnJheSIsImNvdW50U2NvcmVBbGxGaWVsZHMiLCJhbGxUcmliZXNDb2xvciIsImFsbFRvdGVtTmFtZXMiLCJnZXRUcmliZUF0dHJpYnV0dGVzIiwiYXRyaWJ1dGVzIiwibnVtT2Z0cmliZXMiLCJ0cmFiZXNBdHRyIiwicmFuZEF0dHIiLCJpbmRleE9mIiwic2V0VHJhYmVzVGVzdCIsInJlZ2lvbkFyciIsInRyaWJlc0FyciIsInJlZ0FycmF5IiwiY291bnRlciIsImNvdW50Q2hhbmsiLCJzZXRSZWdpb25XaXRoVHJhYmVzIiwicmVnVHJpYmVzIiwid3JpdGVUZXh0IiwidGV4dCIsImdldFRyaWJlc0NvbG9yIiwidHJhYmVzTmFtZSIsImRyYXdFbGVtIiwibmFtZSIsImEiLCJiIiwiYyIsImQiLCJlbGVtIiwiUHJvbWlzZSIsInJlc29sdmUiLCJwYXRoVGVtcGxhdGUiLCJJbWFnZSIsInNyYyIsIm9ubG9hZCIsImdldEZsYWciLCJnYW1lIiwiY2RheSIsInF1ZXJ5U2VsZWN0b3IiLCJjbW91bnQiLCJjeWVhciIsImlubmVySFRNTCIsInRvU3RyaW5nIiwibWFrZVRpbWUiLCJhZGRFdmVudExpc3RlbmVyIiwiYXJyIiwic2NhbGUiLCJBcnJheSIsImZpbGwiLCJmaWxsQXJyV29ybGQiLCJzdGFydFBvaW50IiwiZW5kUG9pbnQiLCJxIiwibGVuIiwic2V0UmFuZG9tU2NvcmVGb3JBbGxBcmVhIiwibWFrZUdyb3VuZCIsInJlZ2lvblNpemUiLCJzdGVwcyIsImdlbmVyYXRlUmVnaW9ucyIsInN0cm9rZVN0eWxlIiwic3Ryb2tlUmVjdCIsImZvbnQiLCJmaWxsVGV4dCIsImRyYXdGaWVsZCIsImNvbnNvbGUiLCJsb2ciLCJhbGxUcmliZXMiLCJ0cmliYWxzIiwidHJpYmVzQ29sb3IiLCJ0cmliZXNUb3RlbU5hbWVzIiwicmdiIiwiSXNsYW5kV2l0aFRyaWJlcyIsInRyaWJlQ29sb3IiLCJkcmF3Rmlyc3RUcmliZXMiLCJpc2xuZEFyciIsImlzbGFuZEFyciIsInRyYkFyciIsImNoYW5rTGltaXRlciIsInRyaWJlc0NoYW5rIiwic2xpY2UiLCJnZW5lcmF0ZUlzbGFuZFdpdGhUcmliZXMiXSwic291cmNlUm9vdCI6IiJ9